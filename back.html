<div id="cloze-is-back" hidden="">{{cloze:Text}}</div>
{{FrontSide}}

<br /><br />

<div class="note-box" hidden="">{{Back Extra}}</div>

<div id="cloze-is-back" hidden="">{{cloze:Text}}</div>
{{FrontSide}}

<br /><br />

<div class="note-box" hidden="">{{Back Extra}}</div>

<script>
  (function applyNotes() {
    const activeCloze = document.querySelector(".cloze");
    const cardOrd = activeCloze.getAttribute("data-ordinal");

    const noteBox = document.querySelector(".note-box");

    const noteBoxContent = noteBox.innerHTML.trim();
    if (noteBoxContent.length == 0) return;

    const notes = noteBoxContent.split("|||");

    for (let i = 0; i < notes.length; i++) {
      note = notes[i].trim().replaceAll("<br>", "");
      if ((note && note[0] !== "C") || note.match(`^C${cardOrd}::`)) {
        const noteContent = note.replace(`C${cardOrd}::`, "");
        noteBox.innerHTML =
          "<span class='note-header'>NOTE</span><p>" + noteContent + "</p>";
        noteBox.hidden = false;
        return;
      }
    }
  })();
</script>
